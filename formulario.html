<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Auditoria CVC - Controle de Infecção</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-top: 15px;
            font-weight: bold;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
        }

        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
        }

        button:hover {
            background-color: #45a049;
        }

        table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            background-color: white;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>Auditoria de Cateter Venoso Central</h2>
            <a href="index.html" style="text-decoration: none;">
                <button type="button" style="background-color: #666;">Voltar ao Menu</button>
            </a>
        </div>
        <form id="cvcForm">
            <div class="form-row">
                <div class="form-group">
                    <label>Nome do Paciente:</label>
                    <input type="text" name="nome" required>
                </div>
                <div class="form-group">
                    <label>Registro/MRN:</label>
                    <input type="text" name="registro" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Data da Auditoria:</label>
                    <input type="date" name="data" required>
                </div>
                <div class="form-group">
                    <label>Setor:</label>
                    <select name="setor" required>
                        <option value="">Selecione o setor</option>
                        <option value="UTI">UTI</option>
                        <option value="Enfermaria">Enfermaria</option>
                        <option value="Centro Cirúrgico">Centro Cirúrgico</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Tipo de Cateter:</label>
                    <select name="tipoCateter" required>
                        <option value="">Selecione</option>
                        <option value="Duplo Lúmen">Duplo Lúmen</option>
                        <option value="Triplo Lúmen">Triplo Lúmen</option>
                        <option value="PICC">PICC</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Local de Inserção:</label>
                    <select name="localInsercao" required>
                        <option value="">Selecione</option>
                        <option value="Jugular">Jugular</option>
                        <option value="Subclávia">Subclávia</option>
                        <option value="Femoral">Femoral</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Data de Inserção:</label>
                    <input type="date" name="dataInsercao">
                </div>
                <div class="form-group">
                    <label>Curativo:</label>
                    <select name="curativo" required>
                        <option value="">Selecione</option>
                        <option value="Limpo">Limpo</option>
                        <option value="Sujo">Sujo</option>
                        <option value="Ausente">Ausente</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>Resultado da Cultura:</label>
                <select name="resultado" required>
                    <option value="">Selecione</option>
                    <option value="Positivo">Positivo</option>
                    <option value="Negativo">Negativo</option>
                    <option value="Em análise">Em análise</option>
                </select>
            </div>

            <div class="form-group">
                <label>Observações:</label>
                <textarea name="obs" rows="3"></textarea>
            </div>

            <button type="submit">Adicionar Registro</button>
        </form>

        <table id="dadosTable">
            <thead>
                <tr>
                    <th>Nome do Paciente</th>
                    <th>Registro/MRN</th>
                    <th>Data da Auditoria</th>
                    <th>Setor</th>
                    <th>Tipo de Cateter</th>
                    <th>Local de Inserção</th>
                    <th>Data de Inserção</th>
                    <th>Curativo</th>
                    <th>Resultado da Cultura</th>
                    <th>Observações</th>
                </tr>
            </thead>
            <tbody>
                <!-- Linhas adicionadas dinamicamente -->
            </tbody>
        </table>
        <button onclick="exportarCSV()">Exportar para Excel (CSV)</button>
    </div>

    <script>
        const form = document.getElementById('cvcForm');
        const tabela = document.getElementById('dadosTable').getElementsByTagName('tbody')[0];
        let dados = [];

        form.onsubmit = function (e) {
            e.preventDefault();
            const formData = new FormData(form);
            const linha = [
                formData.get('nome'),
                formData.get('registro'),
                formData.get('data'),
                formData.get('setor'),
                formData.get('tipoCateter'),
                formData.get('localInsercao'),
                formData.get('dataInsercao'),
                formData.get('curativo'),
                formData.get('resultado'),
                formData.get('obs')
            ];
            dados.push(linha);
            const row = tabela.insertRow();
            linha.forEach(cell => {
                const td = row.insertCell();
                td.textContent = cell;
            });
            form.reset();
        };

        function exportarCSV() {
            let csv = 'Nome do Paciente,Registro/MRN,Data da Auditoria,Setor,Tipo de Cateter,Local de Inserção,Data de Inserção,Curativo,Resultado da Cultura,Observações\n';
            dados.forEach(linha => {
                csv += linha.map(campo => `"${campo}"`).join(',') + '\n';
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dados_cvc.csv';
            a.click();
            URL.revokeObjectURL(url);
        }
    </script>
</body>

</html>